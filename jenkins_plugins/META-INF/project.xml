<?xml version="1.0" encoding="UTF-8"?>
<exportedData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="commander.xsd" version="55" buildLabel="build_4.1_51907_2012.06.29_01:23:43" buildVersion="4.1.1.51907" passkey="a30cbf89cfdae202c5227ce40fe867512295566d">
  <exportPath>/projects/jenkinsIntegration</exportPath>
  <project>
    <projectName>jenkinsIntegration</projectName>
    <description>Procedures to :&#10; - start a build with parameters&#10; - check status of a build</description>
    <resourceName></resourceName>
    <workspaceName></workspaceName>
    <propertySheet>
      <property>
        <propertyName>jenkins</propertyName>
        <propertySheet>
        </propertySheet>
      </property>
      <property>
        <propertyName>ec_setup</propertyName>
        <expandable>1</expandable>
        <value># Data that drives the create step picker registration for this plugin.&#10;my %getDuration = ( &#10;  label       =&gt; "jenkins - Get the duration of a build based on build Number", &#10;  procedure   =&gt; "getDuration", &#10;  description =&gt; "Get the duration of a build based on build Number", &#10;  category    =&gt; "Continuous Integration" &#10;);&#10;&#10;my %getLog = ( &#10;  label       =&gt; "jenkins - Get the full log of a build based on build Number.", &#10;  procedure   =&gt; "getLog", &#10;  description =&gt; "Get the full log of a build based on build Number.", &#10;  category    =&gt; "Continuous Integration" &#10;);&#10;&#10;my %getStatus = ( &#10;  label       =&gt; "jenkins - Get the result of a build based on build Number", &#10;  procedure   =&gt; "getStatus", &#10;  description =&gt; "Get the result of a build based on build Number", &#10;  category    =&gt; "Continuous Integration" &#10;);&#10;&#10;my %startBuild = ( &#10;  label       =&gt; "jenkins - Start a build previously created on Jenkins", &#10;  procedure   =&gt; "startBuild", &#10;  description =&gt; "Start a build previously created on Jenkins", &#10;  category    =&gt; "Continuous Integration" &#10;);&#10;&#10;@::createStepPickerSteps = (\%getDuration, \%getLog, \%getStatus, \%startBuild);&#10;</value>
      </property>
      <property>
        <propertyName>ec_visibility</propertyName>
        <expandable>1</expandable>
        <value>pickerListOnly</value>
      </property>
    </propertySheet>
    <procedure>
      <procedureName>getDuration</procedureName>
      <description>Get the duration of a build based on build Number</description>
      <jobNameTemplate></jobNameTemplate>
      <resourceName></resourceName>
      <workspaceName></workspaceName>
      <propertySheet>
        <property>
          <propertyName>ec_customEditorData</propertyName>
          <propertySheet>
            <property>
              <propertyName>parameters</propertyName>
              <propertySheet>
                <property>
                  <propertyName>authentication</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>checkedValue</propertyName>
                      <expandable>1</expandable>
                      <value>true</value>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                    <property>
                      <propertyName>initiallyChecked</propertyName>
                      <expandable>1</expandable>
                      <value>1</value>
                    </property>
                    <property>
                      <propertyName>uncheckedValue</propertyName>
                      <expandable>1</expandable>
                      <value>false</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsAnon</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>checkedValue</propertyName>
                      <expandable>1</expandable>
                      <value>true</value>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                    <property>
                      <propertyName>initiallyChecked</propertyName>
                      <expandable>1</expandable>
                      <value>1</value>
                    </property>
                    <property>
                      <propertyName>uncheckedValue</propertyName>
                      <expandable>1</expandable>
                      <value>false</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsAuthentication</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>checkedValue</propertyName>
                      <expandable>1</expandable>
                      <value>true</value>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                    <property>
                      <propertyName>initiallyChecked</propertyName>
                      <expandable>1</expandable>
                      <value>1</value>
                    </property>
                    <property>
                      <propertyName>uncheckedValue</propertyName>
                      <expandable>1</expandable>
                      <value>false</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsBuildName</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsBuildNumber</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsPort</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsServer</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsUserCredential</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
              </propertySheet>
            </property>
          </propertySheet>
        </property>
      </propertySheet>
      <formalParameter>
        <formalParameterName>jenkinsAuthentication</formalParameterName>
        <defaultValue>true</defaultValue>
        <description>Boolean to connect to the server wit authentication. If this is set to false, the credentials are ignored</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>checkbox</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsBuildNumber</formalParameterName>
        <defaultValue></defaultValue>
        <description>Jenkins Build Number</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsPort</formalParameterName>
        <defaultValue>8080</defaultValue>
        <description></description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsServer</formalParameterName>
        <defaultValue>jenkins</defaultValue>
        <description>hostname or IP address of the Jenkins server.</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsUserCredential</formalParameterName>
        <defaultValue></defaultValue>
        <description>User authentication to connect to the Jenkins server.</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>credential</type>
      </formalParameter>
      <step>
        <stepName>getDuration</stepName>
        <alwaysRun>0</alwaysRun>
        <broadcast>0</broadcast>
        <command># Standard stuff&#10;use strict;&#10;use LWP::UserAgent;&#10;use ElectricCommander;&#10;&#10;$|=1;&#10;my $ec = new ElectricCommander;&#10;&#10;my $server = "$[jenkinsServer]";&#10;my $port   = "$[jenkinsPort]";&#10;my $buildNumber = "$[jenkinsBuildNumber]";&#10;my $build  = "$[/myProject/jenkins/$[jenkinsServer]/$[jenkinsBuildNumber]/name]";&#10;&#10;my $url = "http://$server:$port/job/$build/$buildNumber/api/xml?xpath=/*/duration";&#10;my $req = HTTP::Request-&gt;new(GET =&gt; $url);;  # HTTP Request&#10;&#10;if ('$[jenkinsAuthentication]' eq 'true') {&#10;  # Get Jenkins user/password from project-level credential&#10;  # getFullCredential will not reveal the contents of the "password" field&#10;  my $xPath = $ec-&gt;getFullCredential("jenkinsUserCredential");&#10;  my $user = $xPath-&gt;findvalue("//userName");&#10;  my $passwd = $xPath-&gt;findvalue("//password");&#10;&#10;  $req-&gt;authorization_basic($user, $passwd);&#10;}&#10;&#10;my $ua  = LWP::UserAgent-&gt;new;&#10;my $res = $ua-&gt;request($req);;&#10;my $duration;&#10; &#10;# check the outcome&#10;if ($res-&gt;is_success) {&#10;  $duration=$res-&gt;decoded_content;&#10;  $duration =~ s#&lt;duration&gt;(\w+)&lt;/duration&gt;#$1#;&#10;  printf("Build %d: %d sec.\n", $buildNumber, $duration);&#10;  $ec-&gt;setProperty("/myProject/jenkins/$server/$buildNumber/duration", $duration);&#10;} else {&#10;  print "Error: " . $res-&gt;status_line . "\n";&#10;}</command>
        <condition></condition>
        <description>Get the duration of the build in seconds</description>
        <errorHandling>failProcedure</errorHandling>
        <exclusiveMode>none</exclusiveMode>
        <logFileName></logFileName>
        <parallel>0</parallel>
        <postProcessor>postp --loadProperty /myStep/matchBuildDuration</postProcessor>
        <releaseMode>none</releaseMode>
        <resourceName></resourceName>
        <shell>ec-perl</shell>
        <timeLimit></timeLimit>
        <timeLimitUnits>minutes</timeLimitUnits>
        <workingDirectory></workingDirectory>
        <workspaceName></workspaceName>
        <propertySheet>
          <property>
            <propertyName>ec_customEditorData</propertyName>
            <propertySheet>
              <property>
                <propertyName>formType</propertyName>
                <expandable>1</expandable>
                <value>command</value>
              </property>
            </propertySheet>
          </property>
          <property>
            <propertyName>matchBuildDuration</propertyName>
            <description></description>
            <expandable>1</expandable>
            <value>push (@::gMatchers,&#10;{&#10;  id =&gt; "buildDurationMatcher",&#10;  pattern =&gt; q{(\d+) sec},&#10;  action =&gt; q {&#10;    setProperty("summary", int($1/1000) .  " seconds");&#10;  }&#10;}, );</value>
          </property>
        </propertySheet>
        <attachedParameters>
          <formalParameterName>jenkinsUserCredential</formalParameterName>
        </attachedParameters>
      </step>
    </procedure>
    <procedure>
      <procedureName>getLog</procedureName>
      <description>Get the full log of a build based on build Number.</description>
      <jobNameTemplate></jobNameTemplate>
      <resourceName></resourceName>
      <workspaceName></workspaceName>
      <propertySheet>
        <property>
          <propertyName>ec_customEditorData</propertyName>
          <propertySheet>
            <property>
              <propertyName>parameters</propertyName>
              <propertySheet>
                <property>
                  <propertyName>jenkinsAuthentication</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>checkedValue</propertyName>
                      <expandable>1</expandable>
                      <value>true</value>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                    <property>
                      <propertyName>initiallyChecked</propertyName>
                      <expandable>1</expandable>
                      <value>1</value>
                    </property>
                    <property>
                      <propertyName>uncheckedValue</propertyName>
                      <expandable>1</expandable>
                      <value>false</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsBuildName</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsBuildNumber</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsPort</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsServer</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsUserCredential</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
              </propertySheet>
            </property>
          </propertySheet>
        </property>
      </propertySheet>
      <formalParameter>
        <formalParameterName>jenkinsAuthentication</formalParameterName>
        <defaultValue>true</defaultValue>
        <description>Boolean to connect to the server wit authentication. If this is set to false, the credentials are ignored</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>checkbox</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsBuildNumber</formalParameterName>
        <defaultValue></defaultValue>
        <description>Jenkins Build Number</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsPort</formalParameterName>
        <defaultValue>8080</defaultValue>
        <description></description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsServer</formalParameterName>
        <defaultValue>jenkins</defaultValue>
        <description>hostname  of the Jenkins server.</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsUserCredential</formalParameterName>
        <defaultValue></defaultValue>
        <description>User authentication to connect to the Jenkins server.</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>credential</type>
      </formalParameter>
      <step>
        <stepName>getConsoleLog</stepName>
        <alwaysRun>0</alwaysRun>
        <broadcast>0</broadcast>
        <command># Standard stuff&#10;use strict;&#10;use LWP::UserAgent;&#10;use ElectricCommander;&#10;&#10;$|=1;&#10;my $ec = new ElectricCommander;&#10;&#10;my $server = "$[jenkinsServer]";&#10;my $port   = "$[jenkinsPort]";&#10;my $buildNumber = "$[/myJob/jenkinsBuildNumber]";&#10;my $build  = "$[/myProject/jenkins/$[jenkinsServer]/$[jenkinsBuildNumber]/name]";&#10;&#10;my $url; ## = "http://$server:$port/job/$build/$buildNumber/logText/progressiveText";&#10;my $req; ## = HTTP::Request-&gt;new(GET =&gt; $url);;  # HTTP Request&#10;my $res;&#10;my $ua  = LWP::UserAgent-&gt;new;&#10;&#10;my $xPath;&#10;my $user;&#10;my $passwd;&#10;&#10;if ('$[jenkinsAuthentication]' eq 'true') {&#10;  # Get Jenkins user/password from project-level credential&#10;  # getFullCredential will not reveal the contents of the "password" field&#10;  $xPath = $ec-&gt;getFullCredential("jenkinsUserCredential");&#10;  $user = $xPath-&gt;findvalue("//userName");&#10;  $passwd = $xPath-&gt;findvalue("//password");&#10;}&#10;&#10;## my $res = $ua-&gt;request($req);;&#10;##  &#10;## # check the outcome&#10;## if ($res-&gt;is_success) {&#10;##   print $res-&gt;decoded_content;&#10;## } else {&#10;##   print "Error: " . $res-&gt;status_line . "\n";&#10;## }&#10;&#10;# Number of bytes already downloaded from the Jenkins log&#10;my $start=0;&#10;&#10;do {&#10;   $url="http://$server:$port/job/$build/$buildNumber/logText/progressiveText?start=$start";&#10;  $ec-&gt;setProperty("/myJob/urlValue", $url);&#10;  $req = HTTP::Request-&gt;new(GET =&gt; $url);&#10;  if ('$[jenkinsAuthentication]' eq 'true') {&#10;    $req-&gt;authorization_basic($user, $passwd);&#10;  }&#10;  $res=$ua-&gt;request($req);&#10;&#10;  # check the outcome&#10;  if ($res-&gt;is_success) {&#10;     print $res-&gt;decoded_content;&#10;     $start += $res-&gt;header("X-Text-Size");&#10;     $ec-&gt;setProperty("/myJob/startValue", $start);&#10;     sleep(5);&#10;  }&#10;  else {&#10;     print "Error: " . $res-&gt;status_line . "\n";&#10;  }&#10;} while ($res-&gt;header("X-More-Data") eq "true") ;</command>
        <condition></condition>
        <description></description>
        <errorHandling>failProcedure</errorHandling>
        <exclusiveMode>none</exclusiveMode>
        <logFileName></logFileName>
        <parallel>0</parallel>
        <postProcessor></postProcessor>
        <releaseMode>none</releaseMode>
        <resourceName></resourceName>
        <shell>ec-perl</shell>
        <timeLimit></timeLimit>
        <timeLimitUnits>minutes</timeLimitUnits>
        <workingDirectory></workingDirectory>
        <workspaceName></workspaceName>
        <propertySheet>
          <property>
            <propertyName>ec_customEditorData</propertyName>
            <propertySheet>
              <property>
                <propertyName>formType</propertyName>
                <expandable>1</expandable>
                <value>command</value>
              </property>
            </propertySheet>
          </property>
        </propertySheet>
        <attachedParameters>
          <formalParameterName>jenkinsUserCredential</formalParameterName>
        </attachedParameters>
      </step>
    </procedure>
    <procedure>
      <procedureName>getStatus</procedureName>
      <description>Get the result of a build based on build Number</description>
      <jobNameTemplate></jobNameTemplate>
      <resourceName></resourceName>
      <workspaceName></workspaceName>
      <propertySheet>
        <property>
          <propertyName>ec_customEditorData</propertyName>
          <propertySheet>
            <property>
              <propertyName>parameters</propertyName>
              <propertySheet>
                <property>
                  <propertyName>jenkinsAuthentication</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>checkedValue</propertyName>
                      <expandable>1</expandable>
                      <value>true</value>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                    <property>
                      <propertyName>initiallyChecked</propertyName>
                      <expandable>1</expandable>
                      <value>1</value>
                    </property>
                    <property>
                      <propertyName>uncheckedValue</propertyName>
                      <expandable>1</expandable>
                      <value>false</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsBuildName</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsBuildNumber</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsPort</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsServer</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsUserCredential</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
              </propertySheet>
            </property>
          </propertySheet>
        </property>
      </propertySheet>
      <formalParameter>
        <formalParameterName>jenkinsAuthentication</formalParameterName>
        <defaultValue>true</defaultValue>
        <description>Boolean to connect to the server wit authentication. If this is set to false, the credentials are ignored</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>checkbox</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsBuildNumber</formalParameterName>
        <defaultValue></defaultValue>
        <description>Jenkins Build Number</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsPort</formalParameterName>
        <defaultValue>8080</defaultValue>
        <description></description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsServer</formalParameterName>
        <defaultValue>jenkins</defaultValue>
        <description>hostname or IP address of the Jenkins server.</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsUserCredential</formalParameterName>
        <defaultValue></defaultValue>
        <description>User authentication to connect to the Jenkins server.</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>credential</type>
      </formalParameter>
      <step>
        <stepName>getStatus</stepName>
        <alwaysRun>0</alwaysRun>
        <broadcast>0</broadcast>
        <command># Standard stuff&#10;use strict;&#10;use LWP::UserAgent;&#10;use ElectricCommander;&#10;&#10;$|=1;&#10;my $ec = new ElectricCommander;&#10;&#10;my $server = "$[jenkinsServer]";&#10;my $port   = "$[jenkinsPort]";&#10;my $buildNumber = "$[jenkinsBuildNumber]";&#10;my $build  = "$[/myProject/jenkins/$[jenkinsServer]/$[jenkinsBuildNumber]/name]";&#10;&#10;my $url = "http://$server:$port/job/$build/$buildNumber/api/xml?xpath=/*/result";&#10;my $req = HTTP::Request-&gt;new(GET =&gt; $url);;  # HTTP Request&#10;&#10;if ('$[jenkinsAuthentication]' eq 'true') {&#10;  # Get Jenkins user/password from project-level credential&#10;  # getFullCredential will not reveal the contents of the "password" field&#10;  my $xPath = $ec-&gt;getFullCredential("jenkinsUserCredential");&#10;  my $user = $xPath-&gt;findvalue("//userName");&#10;  my $passwd = $xPath-&gt;findvalue("//password");&#10;&#10;  $req-&gt;authorization_basic($user, $passwd);&#10;}&#10;&#10;my $ua  = LWP::UserAgent-&gt;new;&#10;my $res = $ua-&gt;request($req);;&#10;my $status;&#10; &#10;# check the outcome&#10;if ($res-&gt;is_success) {&#10;  $status=$res-&gt;decoded_content;&#10;  $status =~ s#&lt;result&gt;(\w+)&lt;/result&gt;#$1#;&#10;  printf("Build %d: %s\n", $buildNumber, $status);&#10;  $ec-&gt;setProperty("/myProject/jenkins/$server/$buildNumber/status", $status);&#10;} else {&#10;  print "Error: " . $res-&gt;status_line . "\n";&#10;}</command>
        <condition></condition>
        <description></description>
        <errorHandling>failProcedure</errorHandling>
        <exclusiveMode>none</exclusiveMode>
        <logFileName></logFileName>
        <parallel>0</parallel>
        <postProcessor>postp --loadProperty /myStep/matchBuildStatus</postProcessor>
        <releaseMode>none</releaseMode>
        <resourceName></resourceName>
        <shell>ec-perl</shell>
        <timeLimit></timeLimit>
        <timeLimitUnits>minutes</timeLimitUnits>
        <workingDirectory></workingDirectory>
        <workspaceName></workspaceName>
        <propertySheet>
          <property>
            <propertyName>ec_customEditorData</propertyName>
            <propertySheet>
              <property>
                <propertyName>formType</propertyName>
                <expandable>1</expandable>
                <value>command</value>
              </property>
            </propertySheet>
          </property>
          <property>
            <propertyName>matchBuildStatus</propertyName>
            <description></description>
            <expandable>1</expandable>
            <value>push (@::gMatchers,&#10;{&#10;  id =&gt; "buildStatusMatcher",&#10;  pattern =&gt; q{Build \d+: (\w+)},&#10;  action =&gt; q {&#10;    setProperty("summary", "$1");&#10;  }&#10;}, );</value>
          </property>
        </propertySheet>
        <attachedParameters>
          <formalParameterName>jenkinsUserCredential</formalParameterName>
        </attachedParameters>
      </step>
    </procedure>
    <procedure>
      <procedureName>startBuild</procedureName>
      <description>Start a build previously created on Jenkins</description>
      <jobNameTemplate></jobNameTemplate>
      <resourceName></resourceName>
      <workspaceName></workspaceName>
      <propertySheet>
        <property>
          <propertyName>ec_customEditorData</propertyName>
          <propertySheet>
            <property>
              <propertyName>parameters</propertyName>
              <propertySheet>
                <property>
                  <propertyName>jenkinsAuthentication</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>checkedValue</propertyName>
                      <expandable>1</expandable>
                      <value>true</value>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                    <property>
                      <propertyName>initiallyChecked</propertyName>
                      <expandable>1</expandable>
                      <value>1</value>
                    </property>
                    <property>
                      <propertyName>uncheckedValue</propertyName>
                      <expandable>1</expandable>
                      <value>false</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsBuildName</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsBuildParameters</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsPort</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsServer</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>jenkinsUserCredential</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>waiUntilTheEnd</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>checkedValue</propertyName>
                      <expandable>1</expandable>
                      <value>true</value>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                    <property>
                      <propertyName>initiallyChecked</propertyName>
                      <expandable>1</expandable>
                      <value>1</value>
                    </property>
                    <property>
                      <propertyName>uncheckedValue</propertyName>
                      <expandable>1</expandable>
                      <value>false</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>waitUntilTheEnd</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>checkedValue</propertyName>
                      <expandable>1</expandable>
                      <value>true</value>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                    <property>
                      <propertyName>initiallyChecked</propertyName>
                      <expandable>1</expandable>
                      <value>1</value>
                    </property>
                    <property>
                      <propertyName>uncheckedValue</propertyName>
                      <expandable>1</expandable>
                      <value>false</value>
                    </property>
                  </propertySheet>
                </property>
              </propertySheet>
            </property>
          </propertySheet>
        </property>
        <property>
          <propertyName>ec_parameterForm</propertyName>
          <description>Redefine the order of the  UI</description>
          <expandable>1</expandable>
          <value>&lt;editor&gt;&#10;  &lt;formElement&gt;&#10;      &lt;property&gt;jenkinsServer&lt;/property&gt;&#10;      &lt;label&gt;Jenkins Server&lt;/label&gt;&#10;     &lt;documentation&gt;&lt;/documentation&gt;&#10;     &lt;type&gt;entry&lt;/type&gt;&#10;    &lt;required&gt;1&lt;/required&gt;&#10;  &lt;/formElement&gt;&#10;  &lt;formElement&gt;&#10;      &lt;property&gt;jenkinsPort&lt;/property&gt;&#10;      &lt;label&gt;Server port&lt;/label&gt;&#10;     &lt;documentation&gt;&lt;/documentation&gt;&#10;     &lt;type&gt;entry&lt;/type&gt;&#10;     &lt;required&gt;1&lt;/required&gt;&#10;     &lt;value&gt;8080&lt;/value&gt;&#10;  &lt;/formElement&gt;&#10;  &lt;formElement&gt;&#10;      &lt;property&gt;jenkinsBuildName&lt;/property&gt;&#10;      &lt;label&gt;Build Name&lt;/label&gt;&#10;     &lt;documentation&gt;Jenkins build name to start&lt;/documentation&gt;&#10;     &lt;type&gt;entry&lt;/type&gt;&#10;     &lt;required&gt;1&lt;/required&gt;&#10;  &lt;/formElement&gt;&#10;  &lt;formElement&gt;&#10;      &lt;property&gt;jenkinsBuildParameters&lt;/property&gt;&#10;     &lt;documentation&gt;an optional list of parameters in the form param1=value1,param2=value2, ...&lt;/documentation&gt;&#10;      &lt;label&gt;Parameters&lt;/label&gt;&#10;     &lt;type&gt;entry&lt;/type&gt;&#10;  &lt;/formElement&gt;&#10;  &lt;formElement&gt;&#10;      &lt;property&gt;jenkinsAuthentication&lt;/property&gt;&#10;      &lt;label&gt;Authentication required&lt;/label&gt;&#10;     &lt;documentation&gt;Does the server require authentication?&lt;/documentation&gt;&#10;     &lt;type&gt;checkbox&lt;/type&gt;&#10;     &lt;checkedValue&gt;true&lt;/checkedValue&gt;&#10;     &lt;uncheckedValue&gt;false&lt;/uncheckedValue&gt;&#10;  &lt;/formElement&gt;&#10;  &lt;formElement&gt;&#10;      &lt;property&gt;jenkinsUserCredential&lt;/property&gt;&#10;      &lt;label&gt;Credential&lt;/label&gt;&#10;     &lt;documentation&gt;Login and password to connect to the Jenkins server.&lt;/documentation&gt;&#10;     &lt;type&gt;credential&lt;/type&gt;&#10;  &lt;/formElement&gt;&#10;  &lt;formElement&gt;&#10;      &lt;property&gt;waitUntilTheEnd&lt;/property&gt;&#10;      &lt;label&gt;Wait for build to finish&lt;/label&gt;&#10;     &lt;documentation&gt;Wait for the end of the build on the Jenkins server before finishing the Commander Procedure.&lt;/documentation&gt;&#10;     &lt;type&gt;checkbox&lt;/type&gt;&#10;     &lt;value&gt;true&lt;/value&gt;&#10;     &lt;checkedValue&gt;true&lt;/checkedValue&gt;&#10;     &lt;uncheckedValue&gt;false&lt;/uncheckedValue&gt;&#10;     &lt;initiallyChecked&gt;true&lt;/initiallyChecked&gt;&#10;  &lt;/formElement&gt;&#10;&lt;/editor&gt;</value>
        </property>
      </propertySheet>
      <formalParameter>
        <formalParameterName>jenkinsAuthentication</formalParameterName>
        <defaultValue>true</defaultValue>
        <description>Boolean to connect to the server wit authentication. If this is set to false, the credentials are ignored</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>checkbox</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsBuildName</formalParameterName>
        <defaultValue>Povray</defaultValue>
        <description></description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsBuildParameters</formalParameterName>
        <defaultValue>Version=3.6.1,buildLocation=/home/lrochette/source,email=lrochette\@gmail.com,Name=LaurentRochette</defaultValue>
        <description>an option list of parameters in the form param1=value1,param2=value2, ...&#10;In the future we will extract the data from the Jenkins server</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsPort</formalParameterName>
        <defaultValue>8080</defaultValue>
        <description>the default port on the Jenkins Server</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsServer</formalParameterName>
        <defaultValue>jenkins</defaultValue>
        <description></description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>jenkinsUserCredential</formalParameterName>
        <defaultValue></defaultValue>
        <description>User authentication to connect to the Jenkins server.</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>credential</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>waitUntilTheEnd</formalParameterName>
        <defaultValue>true</defaultValue>
        <description>Wait for the end of the build on the Jenkins server before finishing the Commander Procedure.&#10;</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>checkbox</type>
      </formalParameter>
      <step>
        <stepName>startBuild</stepName>
        <alwaysRun>0</alwaysRun>
        <broadcast>0</broadcast>
        <command># Standard stuff&#10;use strict;&#10;use LWP::UserAgent;&#10;use ElectricCommander;&#10;&#10;$|=1;&#10;my $ec = new ElectricCommander;&#10;&#10;# Construct document style URL for entry&#10;my $server = '$[jenkinsServer]';&#10;my $port   = "$[jenkinsPort]";&#10;my $build  = "$[jenkinsBuildName]";&#10;my $params = "$[jenkinsBuildParameters]";&#10;&#10;my $urlBase= "http://$server:$port/job/$build";&#10;my $cmd;&#10;&#10;# Escapify URL&#10;if ($params ne "") {&#10;  $params =~ s/,/\&amp;/g;&#10;  $params =~ s/@/%40/g;&#10;  $cmd = "buildWithParameters?delay=0sec\&amp;".$params;&#10;} else {&#10;  $cmd = "build?delay=0sec";&#10;}&#10;my $url= "$urlBase/$cmd";&#10;&#10;my $req =  HTTP::Request-&gt;new(GET =&gt; $url);&#10;if ('$[jenkinsAuthentication]' eq 'true') {&#10;  # Get Jenkins user/password from project-level credential&#10;  # getFullCredential will not reveal the contents of the "password" field&#10;  my $xPath = $ec-&gt;getFullCredential("jenkinsUserCredential");&#10;  my $user = $xPath-&gt;findvalue("//userName");&#10;  my $passwd = $xPath-&gt;findvalue("//password");&#10;&#10;  $req-&gt;authorization_basic($user, $passwd);&#10;}&#10;&#10;# make the call&#10;my $ua = LWP::UserAgent-&gt;new;&#10;my $res=$ua-&gt;request($req);&#10;print $res;&#10;# Check the outcome of the response&#10;if ($res-&gt;is_success) {&#10;   print "DEBUG: Build $build launched succesfully!\n";&#10; &#10;  if ( $[/javascript (typeof(myProject.jenkins) == "undefined") ? "1":"0"] ) {&#10;    $ec-&gt;createProperty("/myProject/jenkins", {'propertyType' =&gt; "sheet"});&#10;  }&#10;&#10;  if ( $[/javascript (typeof("/myProject/jenkins/$[jenkinsServer]") == "undefined") ? "1":"0"] ) {&#10;    $ec-&gt;createProperty("/myProject/jenkins/$[jenkinsServer]/", {'propertyType' =&gt; "sheet"});&#10;  }&#10;} else {&#10;  print "DEBUG: Build $build launch failed!\n";&#10;  print $res-&gt;status_line, "\n";&#10;  exit 1;&#10;}</command>
        <condition></condition>
        <description></description>
        <errorHandling>failProcedure</errorHandling>
        <exclusiveMode>none</exclusiveMode>
        <logFileName></logFileName>
        <parallel>0</parallel>
        <postProcessor></postProcessor>
        <releaseMode>none</releaseMode>
        <resourceName></resourceName>
        <shell>ec-perl</shell>
        <timeLimit></timeLimit>
        <timeLimitUnits>minutes</timeLimitUnits>
        <workingDirectory></workingDirectory>
        <workspaceName></workspaceName>
        <propertySheet>
          <property>
            <propertyName>ec_customEditorData</propertyName>
            <propertySheet>
              <property>
                <propertyName>formType</propertyName>
                <expandable>1</expandable>
                <value>command</value>
              </property>
            </propertySheet>
          </property>
        </propertySheet>
        <attachedParameters>
          <formalParameterName>jenkinsUserCredential</formalParameterName>
        </attachedParameters>
      </step>
      <step>
        <stepName>getNumber</stepName>
        <alwaysRun>0</alwaysRun>
        <broadcast>0</broadcast>
        <command># Standard stuff&#10;use strict;&#10;use LWP::UserAgent;&#10;use ElectricCommander;&#10;&#10;$|=1;&#10;my $ec = new ElectricCommander;&#10;&#10;# Construct document style URL for entry&#10;my $server = "$[jenkinsServer]";&#10;my $port   = "$[jenkinsPort]";&#10;my $build  = "$[jenkinsBuildName]";&#10;my $params = "$[jenkinsBuildParameters]";&#10;my $buildNumber;&#10;&#10;my $url="http://$server:$port/job/$build/lastBuild/buildNumber";&#10;my $req = HTTP::Request-&gt;new(GET =&gt; $url);&#10;&#10;if ('$[jenkinsAuthentication]' eq 'true') {&#10;  # Get Jenkins user/password from project-level credential&#10;  # getFullCredential will not reveal the contents of the "password" field&#10;  my $xPath = $ec-&gt;getFullCredential("jenkinsUserCredential");&#10;  my $user = $xPath-&gt;findvalue("//userName");&#10;  my $passwd = $xPath-&gt;findvalue("//password");&#10;&#10;  $req-&gt;authorization_basic($user, $passwd);&#10;}&#10;&#10;my $ua = LWP::UserAgent-&gt;new;&#10;my $res=$ua-&gt;request($req);&#10;&#10;# check the outcome&#10;if ($res-&gt;is_success) {&#10;  $buildNumber=$res-&gt;decoded_content;&#10;  print "Build Number: $buildNumber\n";&#10;  $ec-&gt;setProperty("/myJob/jenkinsBuildNumber", $buildNumber);&#10;} else {&#10;  print "Error: " . $res-&gt;status_line . "\n";&#10;}&#10;$ec-&gt;createProperty("/myProject/jenkins/$server/$buildNumber", {'propertyType'=&gt;"sheet"});&#10;$ec-&gt;createProperty("/myProject/jenkins/$server/$buildNumber/status", {'propertyType'=&gt;"string"});&#10;$ec-&gt;createProperty("/myProject/jenkins/$server/$buildNumber/duration", {'propertyType'=&gt;"string"});&#10;$ec-&gt;createProperty("/myProject/jenkins/$server/$buildNumber/name", {'propertyType'=&gt;"string", 'value' =&gt; $build});&#10;$ec-&gt;createProperty("/myProject/jenkins/$server/$buildNumber/parameters", {'propertyType'=&gt;"string", 'value' =&gt;$params} );</command>
        <condition></condition>
        <description>Retrieve the Jenkins Build Number</description>
        <errorHandling>failProcedure</errorHandling>
        <exclusiveMode>none</exclusiveMode>
        <logFileName></logFileName>
        <parallel>0</parallel>
        <postProcessor>postp --loadProperty /myStep/matchBuildNumber</postProcessor>
        <releaseMode>none</releaseMode>
        <resourceName></resourceName>
        <shell>ec-perl</shell>
        <timeLimit></timeLimit>
        <timeLimitUnits>minutes</timeLimitUnits>
        <workingDirectory></workingDirectory>
        <workspaceName></workspaceName>
        <propertySheet>
          <property>
            <propertyName>ec_customEditorData</propertyName>
            <propertySheet>
              <property>
                <propertyName>formType</propertyName>
                <expandable>1</expandable>
                <value>command</value>
              </property>
            </propertySheet>
          </property>
          <property>
            <propertyName>matchBuildNumber</propertyName>
            <description>Match the build number to show it on the status page</description>
            <expandable>1</expandable>
            <value>push (@::gMatchers,&#10;{&#10;  id =&gt; "buildNumberMatcher",&#10;  pattern =&gt; q{Build Number: (\d+)},&#10;  action =&gt; q {&#10;    setProperty("summary", "Build # $1");&#10;  }&#10;}, );</value>
          </property>
          <property>
            <propertyName>summary</propertyName>
            <expandable>1</expandable>
            <value>92</value>
          </property>
        </propertySheet>
        <attachedParameters>
          <formalParameterName>jenkinsUserCredential</formalParameterName>
        </attachedParameters>
      </step>
    </procedure>
  </project>
</exportedData>
